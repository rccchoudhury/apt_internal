# @package _global_

# to execute this validation run:
# python validate.py experiment=validate_vit

defaults:
  - override /data: imagenet
  - override /model: vit
  - override /trainer: default
  - override /callbacks: eval
  #- _self_

tags: ["imagenet", "vanilla", "validation"]

seed: 42

# Disable training and testing
train: false
test: true

trainer:
  accelerator: "gpu"
  devices: 1
  precision: "16-mixed"
  enable_checkpointing: false
  max_epochs: 0
  limit_test_batches: 1.0
  logger: false

model:
  match_head_shape: true
  net:
    _target_: src.models.vision_transformer.VisionTransformer 
    weight_init: 'skip'
  compile: false

data:
  _target_: src.data.imagenet_module.ImagenetDataModule
  batch_size: 64
  num_workers: 12
  pin_memory: true